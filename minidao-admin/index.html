<body id="iwnb">
<meta charset="UTF-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/daisyui@4.10.5/dist/full.min.css" rel="stylesheet" type="text/css"/>
<link href="./output.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" rel="stylesheet" type="text/css"/>
<main class="pt-20 bg-base-100 flex flex-col items-center gap-10" data-theme="dark" style="min-height: 800px">
    <p class="text-white text-3xl">
        MiniDAO - Admin panel
    </p>
    <div class="card w-96 bg-neutral shadow-xl" id="tab-4">
        <form class="card-body flex flex-col space-y-4" id="token-form">
            <div class="flex flex-col gap-2">
                <label for="addresses"
                >Addresses</label
                >
                <textarea class="textarea textarea-bordered min-h-36 max-h-96" id="addresses" name="addresses"
                          placeholder="Enter addresses (each address on a new line)"></textarea>
            </div>
            <button class="btn btn-primary">Mint</button>
        </form>
    </div>
</main>
<script src="https://cdn.jsdelivr.net/npm/toastify-js" type="text/javascript"></script>
<script>
    const callCustomToast = (msg) => {
        Toastify({
                text: msg,
                gravity: "top", // `top` or `bottom`
                position: "center", // `left`, `center` or `right`
            }
        ).showToast();
    }

    const tokenForm = document.getElementById('token-form')
    tokenForm.addEventListener('submit', e => {
        e.preventDefault()
        const formData = new FormData(tokenForm)
        const addresses_input = formData.get('addresses')
        let addresses = addresses_input
            .split("\n")
            .map((address) => address.trim())
            .filter((address) => address.trim() !== "");
        addresses = Array.from(new Set(addresses));

        let error;

        addresses.forEach((address) => {
            if (!/^0x[a-fA-F0-9]{40}$/.test(address)) {
                error = true;
            }
        });

        if (error) {
            callCustomToast(`The field content contains invalid addresses!`)
        } else {
            // ethersjs code
            callCustomToast('All addresses minted successfully!')
            tokenForm.reset()
        }
    })
</script>
</body>